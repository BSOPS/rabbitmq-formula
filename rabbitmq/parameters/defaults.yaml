# -*- coding: utf-8 -*-
# vim: ft=yaml
#
# Set default values.
---
values:
  nodes:
    default:
      clustered: false
      user: rabbit    # 'node' would make more sense here
      host: localhost  # short hostname of node to join to, not fqdn
      runas: rabbitmq
      erlang_cookie: null
      config: {}
        # https://www.rabbitmq.com/ldap.html
        # auth_backends.1: ldap
        # auth_backends.2: internal
        # auth_ldap.servers.1: ldap.eng.megacorp.local
        # auth_ldap.servers.2: 192.168.0.100
        # auth_ldap.user_dn_pattern: cn=${username},ou=People,dc=example,dc=com
        # auth_ldap.use_ssl: false
        # auth_ldap.port: 389
        # auth_ldap.log: false
      service: true
      plugins:
        - rabbitmq_management
        - rabbitmq_federation
        - rabbitmq_federation_management
        # rabbitmq_auth_backend_ldap
      vhosts:
        - '/virtual/host'
      users: {}
      remove_guest_user: true
      policy:
        rabbitmq_policy:
          - name: HA
          - pattern: '.*'
          - definition: '{"ha-mode": "all"}'
      queues: {}

  environ: {}

  pkg:
    name: rabbitmq-server
    # https://github.com/rabbitmq/rabbitmq-server/releases/tag/v3.8.14
    use_upstream: repo    # use upstream repo (if applicable)
    deps:
      - erlang-eldap

  dir:
    base: /usr/lib/rabbitmq
    data: /var/lib/rabbitmq
    config: /etc/rabbitmq
    cleanlist:
      - /usr/local/bin/rabbitmq-env
      - /usr/local/bin/rabbitmq-plugins
      - /var/run/rabbitmq

  rootgroup: root
  locale_all: null
  retry_option:
    # https://docs.saltstack.com/en/latest/ref/states/requisites.html#retrying-states
    attempts: 0
    until: true
    interval: 60
    splay: 10

  # Just here for testing
  added_in_defaults: defaults_value
  winner: defaults
...
